<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DraftKings NFL Showdown Lineup Database</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/papaparse/5.4.1/papaparse.min.js"></script>
</head>
<body class="bg-gray-50">
    <div id="root"></div>
    
    <script type="module">
        const { createRoot } = await import('https://esm.sh/react@18.2.0');
        const { useState, useMemo, useEffect } = await import('https://esm.sh/react@18.2.0');
        const { Search, ArrowUpDown, Filter } = await import('https://esm.sh/lucide-react@0.263.1');

        function NFLLineupViewer() {
            const [searchTerm, setSearchTerm] = useState('');
            const [sortConfig, setSortConfig] = useState({ key: null, direction: 'asc' });
            const [filters, setFilters] = useState({ position: '', team: '', week: '' });
            const [data, setData] = useState([]);
            const [columns, setColumns] = useState([]);
            const [isLoading, setIsLoading] = useState(true);
            const [error, setError] = useState(null);

            useEffect(() => {
                const loadData = async () => {
                    try {
                        const response = await fetch('https://raw.githubusercontent.com/cmain101/Showdown-Data/main/ETR_DK_showdown_data_total.csv');
                        
                        if (!response.ok) {
                            throw new Error('Failed to load data from GitHub');
                        }
                        
                        const csvText = await response.text();
                        
                        Papa.parse(csvText, {
                            header: true,
                            dynamicTyping: true,
                            skipEmptyLines: true,
                            complete: (results) => {
                                if (results.data.length > 0) {
                                    const cleanedData = results.data.map(row => {
                                        const cleanRow = {};
                                        Object.keys(row).forEach(key => {
                                            cleanRow[key.trim()] = row[key];
                                        });
                                        return cleanRow;
                                    });
                                    setColumns(Object.keys(cleanedData[0]));
                                    setData(cleanedData);
                                }
                                setIsLoading(false);
                            },
                            error: (err) => {
                                console.error('Parse error:', err);
                                setError('Failed to parse CSV data');
                                setIsLoading(false);
                            }
                        });
                    } catch (err) {
                        console.error('Error loading data:', err);
                        setError('Failed to load data. Please check your connection and try again.');
                        setIsLoading(false);
                    }
                };

                loadData();
            }, []);

            const handleSort = (key) => {
                let direction = 'asc';
                if (sortConfig.key === key && sortConfig.direction === 'asc') {
                    direction = 'desc';
                }
                setSortConfig({ key, direction });
            };

            const filteredAndSortedData = useMemo(() => {
                let filtered = [...data];

                if (searchTerm) {
                    filtered = filtered.filter(row =>
                        Object.values(row).some(val =>
                            String(val).toLowerCase().includes(searchTerm.toLowerCase())
                        )
                    );
                }

                if (filters.position) {
                    filtered = filtered.filter(row =>
                        String(row['Position(s)'] || '').toLowerCase().includes(filters.position.toLowerCase())
                    );
                }

                if (filters.team) {
                    filtered = filtered.filter(row =>
                        String(row['Team'] || '').toLowerCase().includes(filters.team.toLowerCase())
                    );
                }

                if (filters.week) {
                    filtered = filtered.filter(row =>
                        String(row['Week(s)'] || '').toLowerCase().includes(filters.week.toLowerCase())
                    );
                }

                if (sortConfig.key) {
                    filtered.sort((a, b) => {
                        const aVal = a[sortConfig
